# üéØ DETAILED VULNERABILITY LOCATIONS
## Exact File Names and Line Numbers

**Purpose:** This document provides precise locations of every security vulnerability found in the codebase.

---

## üîê AUTHENTICATION VULNERABILITIES

### 1. Hardcoded Admin Credentials

#### **File:** `src/Components/LoginModal.jsx`
**Lines:** 11-16
```javascript
11:  if (credentials.username === 'admin' && credentials.password === 'admin123') {
12:    onLogin(true);
13:    onClose();
14:  } else {
15:    alert('Invalid credentials');
16:  }
```
**Issue:** Hardcoded admin username and password in frontend code  
**Risk:** Anyone with access to source code can authenticate as admin  
**Fix:** Remove client-side authentication entirely; move to backend

---

#### **File:** `src/Pages/Hotels.jsx`
**Lines:** 1418-1424
```javascript
1418:  const [adminUser] = useState({
1419:    id: 999,
1420:    name: 'Admin User',
1421:    email: 'admin@traveligo.com', 
1422:    password: 'admin123',  // ‚ö†Ô∏è HARDCODED PASSWORD
1423:    role: 'admin'
1424:  });
```
**Issue:** Admin password stored in plain text in component state  
**Risk:** Compromised admin account  
**Fix:** Remove this entirely; use backend authentication

---

**Lines:** 1400-1413
```javascript
1400:  hotelName: 'Hotel Dal View',
1401:  ownerName: 'Rajesh Kumar',
1402:  email: 'hoteldalview@example.com', 
1403:  password: 'hotel123',  // ‚ö†Ô∏è HARDCODED PASSWORD
1404:  role: 'hotel',
1405:  phone: '+91 9876543210',
1406:  address: 'Boulevard Road, Srinagar',
1407:  city: 'Srinagar',
1408:  pincode: '190001',
1409:  gstNumber: 'GSTIN123456789',
1410:  panNumber: 'ABCDE1234F',
1411:  hotels: [1],
1412:  registrationDate: new Date('2024-01-01').toISOString()
1413: }
```
**Issue:** Demo hotel user with hardcoded password  
**Risk:** Unauthorized hotel portal access  
**Fix:** Remove demo data; use database with hashed passwords

---

**Lines:** 2010-2025
```javascript
2010:  if (loginForm.email === adminUser.email && 
2011:      loginForm.password === adminUser.password) {
2012:    
2013:    setCurrentUser(adminUser);
2014:    setIsAuthenticated(true);
2015:    setUserRole('admin');
2016:    setShowLoginModal(false);
2017:    
2018:    localStorage.setItem('currentUser', JSON.stringify(adminUser));
2019:    localStorage.setItem('isAuthenticated', 'true');
2020:    localStorage.setItem('userRole', 'admin');
2021:    
2022:    setLoginForm({
2023:      email: '',
2024:      password: '',
2025:      role: 'hotel'
```
**Issue:** Client-side authentication logic without server verification  
**Risk:** Authentication can be bypassed via browser console  
**Fix:** Implement server-side authentication with JWT

---

## üí∞ EXPOSED API KEYS & SECRETS

### 2. EmailJS Credentials (Public Keys)

Found in **41 files** - showing pattern locations:

#### **File:** `src/Footer/Bali.jsx`
**Line 131:** `emailjs.init('37pN2ThzFwwhwk7ai');`  
**Lines 133-135:**
```javascript
133:  const result = await emailjs.send(
134:    'service_ov629rm',      // ‚ö†Ô∏è SERVICE ID
135:    'template_jr1dnto',     // ‚ö†Ô∏è TEMPLATE ID
```

#### **File:** `src/Footer/Lakshadweep.jsx`
**Line 128:** `emailjs.init('37pN2ThzFwwhwk7ai');`  
**Lines 130-132:**
```javascript
130:  const result = await emailjs.send(
131:    'service_ov629rm',
132:    'template_jr1dnto',
```

**Same pattern in all these files:**
- src/Footer/Himachal.jsx
- src/Footer/Dubai.jsx
- src/Footer/Nepal.jsx
- src/Footer/Vietnam.jsx
- src/Footer/Rajasthan.jsx
- src/Footer/Japan.jsx
- src/Footer/Hong.jsx
- src/Footer/honeymoon.jsx
- src/Footer/Kerala.jsx
- src/Footer/Egypt.jsx
- src/Footer/Russia.jsx
- src/Footer/Banglore.jsx
- src/Footer/NewZealand.jsx
- src/Footer/Turkey.jsx
- src/Footer/Uzbekistan.jsx
- src/Footer/Singapore.jsx
- src/Footer/Kazakhstan.jsx
- src/Footer/Cancellation.jsx
- src/Footer/kashmir.jsx
- src/Footer/Thailand.jsx
- src/Footer/Spiti.jsx
- src/Footer/Azarbaijan.jsx
- src/Footer/Almaty.jsx
- src/Footer/Goa.jsx
- src/Footer/Bhutan.jsx
- src/Footer/South.jsx
- src/Footer/Srilanka.jsx
- src/Footer/Mauritius.jsx
- src/Footer/SouthAfrica.jsx
- src/Footer/GangtokDarjeeling.jsx
- src/Footer/ladkah.jsx
- src/Footer/Andaman.jsx
- src/Footer/contact.jsx
- src/Footer/Utrakhand.jsx
- src/Footer/Meghalaya.jsx
- src/Footer/MadhyaPradesh.jsx
- src/Footer/Georgia.jsx
- src/Components/Footer.jsx
- src/Pages/Home.jsx
- src/Pages/Hotels.jsx
- src/Pages/Holidays.jsx

**Issue:** EmailJS credentials duplicated across 41 files  
**Risk:** 
- Keys exposed in public source code
- Anyone can use your EmailJS account
- Potential email quota exhaustion
- Spam/abuse of your email service

**Fix:** 
1. Rotate EmailJS credentials immediately
2. Move to environment variables
3. Create centralized email service
4. Implement server-side email sending

---

### 3. Razorpay Live API Key (CRITICAL)

Found in **41 files** - showing pattern locations:

#### **File:** `src/Footer/Bali.jsx`
**Line 206:**
```javascript
206:  key: "rzp_live_R8Ga0PdPPfJptw",  // ‚ö†Ô∏è LIVE PAYMENT KEY
```

#### **File:** `src/Footer/Lakshadweep.jsx`
**Line 202:**
```javascript
202:  key: "rzp_live_R8Ga0PdPPfJptw",  // ‚ö†Ô∏è LIVE PAYMENT KEY
```

**Same key exposed in:**
- All 41 files listed in EmailJS section above

**Issue:** Production Razorpay API key hardcoded in frontend  
**Risk:** 
- ‚ö†Ô∏è **CRITICAL FINANCIAL RISK**
- Unauthorized payment processing
- Fraudulent transactions
- Financial losses
- Payment manipulation

**Immediate Action:**
1. **ROTATE KEY IMMEDIATELY** via Razorpay dashboard
2. Enable IP whitelisting on Razorpay
3. Move key to backend only
4. Never expose payment keys in frontend
5. Review all transactions for unauthorized activity

---

### 4. Exposed Secrets in `.env.sample`

#### **File:** `.env.sample`
**Lines 1-17:**
```env
1:  PORT=5000
2:  VITE-APIWRITE-PROJECT-ID="6885f26f0003e6f1e60b"
3:  VITE-APIWRITE-BUCKET-ID="6885f4f80023055bb037"
4:  VITE-APIWRITE-DATABASE-ID="6885f33f002d2f3fee42"
5:  VITE-APIWRITE-URL="https://nyc.cloud.appwrite.io/v1"
6:  VITE-APIWRITE-COLLECTION-ID="6885f375001315a9dd6f"
7:  VITE_API_BASE_URL="http://localhost:5000"
8:  NODE_ENV="development"
9:  JWT_SECRET="6c7ab973e184fbac39963bed0d954feac2c0e7af4dccbb561e3fc5420402a892"
10: MONGO_URI="mongodb://localhost:27017/omairiq"
11: AIRIQ_API_BASE_URL="https://omairiq.azurewebsites.net"
12: AIRIQ_API_KEY="ODY1MDc1MDpUcmF2ZWxpZ286MTM4NzM3Mjg2MjUwMjpCZWwwWXh3QWJQOU1iRkxYd0psYnBQRlh2c0ZEM2JkVVRBc0wvdWZydUtvPQ=="
13: AIRIQ_LOGIN_ID="7006933649"
14: AIRIQ_PASSWORD="7006933649"
15: RAZORPAY_KEY_ID="rzp_live_R8Ga0PdPPfJptw"
16: RAZORPAY_SECRET="0gZtKqICXnr3QZ4Q5XAEoPa2"
17:
```

**Issues Found:**
- **Line 9:** JWT secret key exposed (used to sign authentication tokens)
- **Line 10:** MongoDB connection string (no auth, but database name exposed)
- **Line 12:** AIRIQ API key (looks like Base64 encoded credentials)
- **Lines 13-14:** AIRIQ login credentials (phone number used as password)
- **Line 15:** Razorpay Live Key ID (duplicates frontend exposure)
- **Line 16:** **Razorpay Secret Key** (backend secret - CRITICAL!)

**Risk Level:** üî¥ **CRITICAL**
- JWT secret compromise allows token forgery
- Database access if MongoDB has no auth
- Third-party API abuse (AIRIQ)
- Complete payment gateway compromise (Razorpay secret)

**Immediate Actions:**
1. Delete or rename `.env.sample` to `.env.example`
2. Replace all real values with placeholders in `.env.example`
3. Rotate ALL these credentials immediately:
   - Generate new JWT secret: `node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"`
   - Rotate Razorpay keys via dashboard
   - Change AIRIQ API credentials
   - Add authentication to MongoDB
4. Add `.env` to `.gitignore` (already present, but verify `.env` not committed)

---

## üîì INSECURE DATA STORAGE

### 5. localStorage Usage for Sensitive Data

#### **File:** `src/Pages/Hotels.jsx`

**Lines 1300:**
```javascript
1300:  const saved = localStorage.getItem('kashmirStays_hotels');
```
**Issue:** Hotel data stored in browser localStorage  
**Risk:** Data tampering, XSS data theft

---

**Lines 1390:**
```javascript
1390:  const saved = localStorage.getItem('kashmirStays_pendingHotels');
```
**Issue:** Pending hotel registrations in localStorage  
**Risk:** Sensitive registration data exposed

---

**Lines 1396:**
```javascript
1396:  const saved = localStorage.getItem('kashmirStays_hotelUsers');
```
**Issue:** Hotel user accounts (including passwords) in localStorage  
**Risk:** Password theft, account compromise

---

**Lines 1472:**
```javascript
1472:  localStorage.setItem('kashmirStays_hotels', JSON.stringify(hotels));
```
**Issue:** Writing hotel data to localStorage  
**Risk:** Data persistence in insecure storage

---

**Lines 1476:**
```javascript
1476:  localStorage.setItem('kashmirStays_pendingHotels', JSON.stringify(pendingHotels));
```
**Issue:** Writing pending hotels to localStorage  
**Risk:** Sensitive business data exposed

---

**Lines 1480:**
```javascript
1480:  localStorage.setItem('kashmirStays_hotelUsers', JSON.stringify(hotelUsers));
```
**Issue:** Writing user credentials to localStorage  
**Risk:** **CRITICAL** - Passwords stored in plain text

---

**Lines 1485-1499:**
```javascript
1485:  const savedUser = localStorage.getItem('currentUser');
1486:  const savedAuth = localStorage.getItem('isAuthenticated');
1487:  const savedRole = localStorage.getItem('userRole');
1488:  
1489:  if (savedUser && savedAuth === 'true' && savedRole) {
1490:    try {
1491:      const user = JSON.parse(savedUser);
1492:      setCurrentUser(user);
1493:      setIsAuthenticated(true);
1494:      setUserRole(savedRole);
1495:    } catch (e) {
1496:      console.error('Error loading saved user:', e);
1497:      localStorage.removeItem('currentUser');
1498:      localStorage.removeItem('isAuthenticated');
1499:      localStorage.removeItem('userRole');
```
**Issue:** Authentication state persisted in localStorage  
**Risk:** Authentication bypass, session hijacking

---

**Lines 1615-1617:**
```javascript
1615:  localStorage.removeItem('currentUser');
1616:  localStorage.removeItem('isAuthenticated');
1617:  localStorage.removeItem('userRole');
```
**Issue:** Logout only clears localStorage (no server-side session invalidation)  
**Risk:** Token remains valid if stolen before logout

---

**Lines 2018-2020:**
```javascript
2018:  localStorage.setItem('currentUser', JSON.stringify(adminUser));
2019:  localStorage.setItem('isAuthenticated', 'true');
2020:  localStorage.setItem('userRole', 'admin');
```
**Issue:** Admin authentication state stored in localStorage  
**Risk:** Admin privileges can be set via browser console

---

## üåê BACKEND SECURITY ISSUES

### 6. Unprotected Payment Endpoint

#### **File:** `Server/server.js`

**Lines 102-140:**
```javascript
102: app.post("/api/order", (req, res) => {
103:   console.log("üõí Order request received");
104:   
105:   try {
106:     const { flightId, passengers, contactInfo } = req.body;
107:     
108:     // Validate required fields
109:     if (!flightId || !passengers || !contactInfo) {
110:       return res.status(400).json({
111:         success: false,
112:         message: "Missing required fields"
113:       });
114:     }
115:     
116:     // Simulate processing
117:     setTimeout(() => {
118:       const bookingRef = `BK${Date.now()}`;
119:       
120:       res.json({
121:         success: true,
122:         message: "Booking confirmed!",
123:         bookingReference: bookingRef,
124:         orderDetails: {
125:           flightId,
126:           passengers: passengers.length,
127:           totalAmount: 12500,  // ‚ö†Ô∏è HARDCODED AMOUNT
128:           currency: "INR"
129:         }
130:       });
131:     }, 1000);
132:     
133:   } catch (error) {
134:     console.error("Order error:", error);
135:     res.status(500).json({
136:       success: false,
137:       message: "Order processing failed"
138:     });
139:   }
140: });
```

**Issues:**
- **Line 102:** No authentication middleware
- **Line 106:** No input validation beyond basic check
- **Line 127:** Hardcoded amount - client could send any value
- **Missing:** No database verification of prices
- **Missing:** No payment verification before confirming order

**Risk:** 
- Unauthorized order creation
- Price manipulation
- Fake bookings
- Revenue loss

---

### 7. Insecure CORS Configuration

#### **File:** `Server/server.js`

**Lines 16-20:**
```javascript
16: app.use(cors({
17:   origin: "*",  // ‚ö†Ô∏è WILDCARD - Allows ALL origins
18:   methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
19:   allowedHeaders: ["Content-Type", "Authorization"]
20: }));
```

**Issue:** CORS allows any website to make requests  
**Risk:** 
- CSRF attacks
- Data theft
- Unauthorized API access from malicious sites

**Fix:**
```javascript
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(',') || ['http://localhost:5173'],
  credentials: true,
  methods: ["GET", "POST", "PUT", "DELETE"],
  allowedHeaders: ["Content-Type", "Authorization"]
}));
```

---

### 8. Missing Security Middleware

#### **File:** `Server/server.js`

**Security middleware installed but NOT used:**
- **Helmet.js** - Line 28 in package.json (installed) but not in server.js
- **Express Rate Limit** - Line 34 in package.json (installed) but not configured
- **Express Validator** - Line 35 in package.json (installed) but not used

**Issue:** Security packages installed but not activated  
**Risk:** Application vulnerable to:
- Header injection attacks
- Rate limit abuse
- DDoS attacks
- Input validation bypasses

---

### 9. Database Connection Issues

#### **File:** `Server/server.js`

**Lines 2-4:**
```javascript
2: const express = require("express");
3: const mongoose = require("mongoose");  // ‚ö†Ô∏è Imported but not used
4: const dotenv = require("dotenv");
```

**Issue:** Mongoose imported but no database connection established  
**Risk:** Application not using persistent database; relying on localStorage

**Missing in server.js:**
```javascript
mongoose.connect(process.env.MONGO_URI, {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() => console.log('MongoDB connected'))
  .catch(err => console.error('MongoDB error:', err));
```

---

## üåç FRONTEND VULNERABILITIES

### 10. Hardcoded API URLs

#### **File:** `src/Components/Razorpay.jsx`

**Line 8:**
```javascript
8: const response = await fetch("http://localhost:5000/order", {
```

**Issue:** Hardcoded localhost URL in production code  
**Risk:** Breaks in production; exposes development endpoints

---

#### **File:** `src/Pages/Flights.jsx`

**Lines 31:**
```javascript
31: const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000';
```

**Issue:** Fallback to localhost if env variable not set  
**Better:** Fail gracefully or use production URL as fallback

---

### 11. Potential XSS Vulnerabilities

#### **Pattern found in multiple files:**
User input rendered without sanitization in:
- Hotel names
- User reviews
- Booking confirmations
- Form submissions

**Example risk:**
If a hotel name is `<script>alert('XSS')</script>`, it could execute when rendered.

**Files to review for XSS:**
- src/Pages/Hotels.jsx (hotel data rendering)
- src/Footer/*.jsx (destination pages with dynamic content)
- src/Components/Testimonials.jsx (user reviews)

**Fix:** Install and use DOMPurify:
```javascript
import DOMPurify from 'dompurify';

// Sanitize before rendering
<div>{DOMPurify.sanitize(userInput)}</div>
```

---

### 12. External Scripts Without SRI

#### **File:** `src/App.jsx`

**Lines 86-93:**
```javascript
86:  useEffect(() => {
87:    // Load Shapo script once
88:    if (!document.getElementById('shapo-embed-js')) {
89:      const script = document.createElement('script');
90:      script.id = 'shapo-embed-js';
91:      script.src = 'https://cdn.shapo.io/js/embed.js';  // ‚ö†Ô∏è No SRI
92:      script.defer = true;
93:      document.body.appendChild(script);
```

**Lines 96-103:**
```javascript
96:    if (!document.getElementById('google-reviews-script')) {
97:      const script = document.createElement('script');
98:      script.id = 'google-reviews-script';
99:      script.src = 'https://static.elfsight.com/platform/platform.js';  // ‚ö†Ô∏è No SRI
100:     script.defer = true;
101:     script.dataset.useServiceCore = true;
102:     document.body.appendChild(script);
103:   }
```

**Issue:** Loading third-party scripts without Subresource Integrity  
**Risk:** 
- Script tampering
- Supply chain attacks
- Malicious code injection if CDN compromised

**Fix:** Add SRI hashes:
```javascript
script.integrity = "sha384-[HASH]";
script.crossOrigin = "anonymous";
```

---

## üìù SUMMARY OF CRITICAL LOCATIONS

### **Files Requiring Immediate Attention:**

1. **`.env.sample`** ‚Üí Delete or sanitize (Lines 1-17)
2. **`src/Components/LoginModal.jsx`** ‚Üí Remove entirely (Lines 1-65)
3. **`src/Pages/Hotels.jsx`** ‚Üí Complete refactor needed (Lines 1-2500+)
4. **`Server/server.js`** ‚Üí Add auth middleware, secure CORS (Lines 16-20, 102-140)
5. **All 41 files with EmailJS/Razorpay** ‚Üí Centralize and move to env vars

### **Line Count of Vulnerable Code:**

| Vulnerability Type | Files Affected | Approximate Lines |
|-------------------|----------------|-------------------|
| Hardcoded API Keys | 41 files | ~500 lines |
| Client-side Auth | 2 files | ~300 lines |
| localStorage Usage | 1 file | ~50 lines |
| Unprotected Endpoints | 1 file | ~40 lines |
| CORS Issues | 1 file | 5 lines |

### **Total Vulnerable Code:** ~895+ lines across 43 files

---

## üîß PRIORITY FIX ORDER

### **Phase 1 (24 hours):**
1. Rotate all exposed API keys (Razorpay, EmailJS, AIRIQ)
2. Delete/sanitize `.env.sample`
3. Remove hardcoded credentials from Hotels.jsx and LoginModal.jsx

### **Phase 2 (1 week):**
1. Implement backend authentication (Server/routes/auth.js)
2. Add auth middleware to protected routes
3. Create centralized services (src/services/)
4. Refactor all 41 files to use centralized services

### **Phase 3 (2 weeks):**
1. Replace localStorage with secure cookies
2. Fix CORS configuration
3. Add input validation
4. Enable Helmet.js and rate limiting

---

**Document Version:** 1.0  
**Last Updated:** October 16, 2025  
**Status:** Active Security Audit

